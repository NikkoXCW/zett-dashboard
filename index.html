<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZETT Trial Data</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; background: #f9f9f9; }
        h1 { color: #333; }
        .container { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; margin: 20px; }
        .data-box { background: white; padding: 20px; width: 200px; border-radius: 10px; box-shadow: 2px 2px 10px rgba(0,0,0,0.1); text-align: center; }
        .data-title { font-weight: bold; color: #555; margin-bottom: 10px; }
        .data-value { font-size: 24px; font-weight: bold; color: #007bff; }
    </style>
</head>
<body>

    <h1>Live Google Sheets Data</h1>
    <div class="container" id="dataContainer">Loading...</div>

    <script>
        const sheetURL = "https://docs.google.com/spreadsheets/d/1Tw-3NfzRG7JhzLsjLBfrRF__Plo4BZS8RWRa-csbiH4/edit?gid=1004681162";
        
        async function fetchData() {
            try {
                const response = await fetch(sheetURL);
                const text = await response.text();
                const json = JSON.parse(text.substring(47, text.length - 2));

                let html = "";
                json.table.rows.forEach(row => {
                    const title = row.c[0]?.v || "No Title";
                    const value = row.c[1]?.v || "0";

                    html += `<div class="data-box">
                                <div class="data-title">${title}</div>
                                <div class="data-value">${value}</div>
                            </div>`;
                });

                document.getElementById("dataContainer").innerHTML = html;
            } catch (error) {
                console.error("Error fetching data:", error);
                document.getElementById("dataContainer").innerHTML = "Failed to load data.";
            }
        }

        // Fetch data initially & refresh every 10 seconds
        fetchData();
        setInterval(fetchData, 10000);
    </script>

</body>
</html>
